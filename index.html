<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>FIFA Draft & Match Simulation</title>

<style>
body {
  margin: 0;
  background: #0b0b0b;
  color: white;
  font-family: Arial, sans-serif;
  text-align: center;
}

h1, h2 {
  margin: 14px 0 6px;
}

.pack {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  padding: 10px;
  max-width: 360px;
  margin: auto;
}

.pack img {
  width: 100%;
  max-width: 90px;
  border-radius: 8px;
  cursor: pointer;
}

.team {
  max-width: 360px;
  margin: auto;
  padding-bottom: 12px;
}

.row {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin: 5px 0;
}

.slot {
  width: 85px;
  height: 130px;
  border: 2px dashed #555;
  border-radius: 8px;
}

.slot img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

button {
  margin: 16px;
  padding: 12px 20px;
  font-size: 16px;
  background: #1db954;
  border: none;
  border-radius: 6px;
  color: black;
  cursor: pointer;
}

#result {
  font-size: 16px;
  margin-bottom: 20px;
  white-space: pre-line;
}
</style>
</head>

<body>

<h1>PACK</h1>
<div class="pack" id="pack"></div>

<h2>TEAM A</h2>
<div class="team" id="teamA"></div>

<h2>TEAM B</h2>
<div class="team" id="teamB"></div>

<button onclick="playMatch()">PLAY MATCH</button>
<div id="result"></div>

<script>
/* ======================================================
   CARD DATABASE (YOU EDIT THIS)
====================================================== */

const ALL_CARDS = [
  { img:"fifa-cards/messi20.png", name:"Messi", position:"ATT", rating:95 },
  { img:"fifa-cards/ronaldo20.png", name:"Ronaldo", position:"ATT", rating:94 },
  { img:"fifa-cards/neymar15.png", name:"Neymar", position:"ATT", rating:93 },

  { img:"fifa-cards/xavi12.png", name:"Xavi", position:"MID", rating:91 },
  { img:"fifa-cards/iniesta12.png", name:"Iniesta", position:"MID", rating:92 },
  { img:"fifa-cards/modric13.png", name:"Modric", position:"MID", rating:91 },

  { img:"fifa-cards/maldini13.png", name:"Maldini", position:"DEF", rating:94 },
  { img:"fifa-cards/cannavaro12.png", name:"Cannavaro", position:"DEF", rating:92 },
  { img:"fifa-cards/ramos14.png", name:"Ramos", position:"DEF", rating:91 },

  { img:"fifa-cards/neuer14.png", name:"Neuer", position:"GK", rating:92 },
  { img:"fifa-cards/buffon13.png", name:"Buffon", position:"GK", rating:91 }
];

/* ======================================================
   STATE
====================================================== */

let deck = [...ALL_CARDS];
let packCards = [];
let selectedCard = null;
let picksThisRound = 0;

const teamA = [];
const teamB = [];

const packEl = document.getElementById("pack");
const teamAEl = document.getElementById("teamA");
const teamBEl = document.getElementById("teamB");
const resultEl = document.getElementById("result");

/* ======================================================
   FORMATION
====================================================== */

function buildTeam(el, teamArr) {
  el.innerHTML = "";
  [3,3,4,1].forEach(count => {
    const row = document.createElement("div");
    row.className = "row";

    for (let i = 0; i < count; i++) {
      const slot = document.createElement("div");
      slot.className = "slot";
      slot.onclick = () => placeCard(slot, teamArr);
      row.appendChild(slot);
    }

    el.appendChild(row);
  });
}

/* ======================================================
   PACK LOGIC
====================================================== */

function dealPack() {
  packEl.innerHTML = "";
  picksThisRound = 0;
  selectedCard = null;

  deck.sort(() => Math.random() - 0.5);
  packCards = deck.slice(0, 6);

  packCards.forEach(card => {
    const img = document.createElement("img");
    img.src = card.img;
    img.onclick = () => selectCard(card, img);
    packEl.appendChild(img);
  });
}

function selectCard(card, img) {
  selectedCard = card;
  [...packEl.children].forEach(i => i.style.opacity = 1);
  img.style.opacity = 0.4;
}

function placeCard(slot, teamArr) {
  if (!selectedCard || slot.innerHTML) return;

  const img = document.createElement("img");
  img.src = selectedCard.img;
  slot.appendChild(img);

  teamArr.push(selectedCard);
  deck = deck.filter(c => c !== selectedCard);
  selectedCard = null;
  picksThisRound++;

  if (picksThisRound === 2) dealPack();
}

/* ======================================================
   MATCH SIMULATION
====================================================== */

function playMatch() {
  if (teamA.length < 11 || teamB.length < 11) {
    alert("Both teams must have 11 players");
    return;
  }

  const simA = simulateTeam(teamA);
  const simB = simulateTeam(teamB);

  let log = "";

  const goalsA = Math.max(0, Math.round(simA.attack - simB.defence + rand(0,2)));
  const goalsB = Math.max(0, Math.round(simB.attack - simA.defence + rand(0,2)));

  log += goalLog("Team A", simA.attackers, goalsA);
  log += goalLog("Team B", simB.attackers, goalsB);

  log += `\nFINAL SCORE\nTeam A ${goalsA} - ${goalsB} Team B\n`;

  if (goalsA > goalsB) log += "TEAM A WINS ðŸ†";
  else if (goalsB > goalsA) log += "TEAM B WINS ðŸ†";
  else log += "DRAW ðŸ¤";

  resultEl.textContent = log;
}

function simulateTeam(team) {
  const attackers = team.filter(p => p.position === "ATT");
  const mids = team.filter(p => p.position === "MID");
  const defs = team.filter(p => p.position === "DEF");
  const gk = team.find(p => p.position === "GK");

  return {
    attackers,
    attack: avg(attackers)*1.2 + avg(mids)*0.6,
    defence: avg(defs)*1.1 + (gk ? gk.rating : 70)
  };
}

function goalLog(teamName, attackers, goals) {
  let log = "";
  for (let i = 0; i < goals; i++) {
    const scorer = attackers[Math.floor(Math.random()*attackers.length)];
    const minute = rand(1,90);
    log += `${minute}' âš½ ${teamName}: ${scorer.name}\n`;
  }
  return log;
}

/* ======================================================
   HELPERS
====================================================== */

const avg = arr => arr.length ? arr.reduce((s,p)=>s+p.rating,0)/arr.length : 50;
const rand = (a,b) => Math.floor(Math.random()*(b-a+1))+a;

/* ======================================================
   INIT
====================================================== */

buildTeam(teamAEl, teamA);
buildTeam(teamBEl, teamB);
dealPack();
</script>

</body>
</html>
