<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>FIFA Draft & Match</title>

<style>
body {
  margin: 0;
  background: #0b0b0b;
  color: white;
  font-family: Arial, sans-serif;
  text-align: center;
}

h1, h2 {
  margin: 14px 0 6px;
}

.pack {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  padding: 10px;
  max-width: 360px;
  margin: auto;
}

.pack img {
  width: 100%;
  max-width: 90px;
  border-radius: 8px;
  cursor: pointer;
}

.team {
  max-width: 360px;
  margin: auto;
  padding-bottom: 12px;
}

.row {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin: 5px 0;
}

.slot {
  width: 85px;
  height: 130px;
  border: 2px dashed #555;
  border-radius: 8px;
}

.slot img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

button {
  margin: 14px;
  padding: 12px 20px;
  font-size: 16px;
  background: #1db954;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

#result {
  margin-bottom: 20px;
  font-size: 18px;
}
</style>
</head>

<body>

<h1>PACK</h1>
<div class="pack" id="pack"></div>

<h2>TEAM A</h2>
<div class="team" id="teamA"></div>

<h2>TEAM B</h2>
<div class="team" id="teamB"></div>

<button onclick="playMatch()">PLAY MATCH</button>
<div id="result"></div>

<script>
/* ================= PLAYER DATABASE ================= */

const players = [
  // --- PUYOL ---
  { name: "Puyol", rating: 95, position: "DEF", img: "fifa-cards/puyol10.png" },
  { name: "Puyol", rating: 94, position: "DEF", img: "fifa-cards/puyol11.png" },
  { name: "Puyol", rating: 92, position: "DEF", img: "fifa-cards/puyol12.png" },
  { name: "Puyol", rating: 92, position: "DEF", img: "fifa-cards/puyol13.png" },

  // --- SCHMEICHEL ---
  { name: "Schmeichel", rating: 96, position: "GK", img: "fifa-cards/schmeichel10.png" },
  { name: "Schmeichel", rating: 95, position: "GK", img: "fifa-cards/schmeichel11.png" },
  { name: "Schmeichel", rating: 92, position: "GK", img: "fifa-cards/schmeichel12.png" },
  { name: "Schmeichel", rating: 86, position: "GK", img: "fifa-cards/schmeichel13.png" },

  // --- THURAM ---
  { name: "Thuram", rating: 95, position: "DEF", img: "fifa-cards/thuram10.png" },
  { name: "Thuram", rating: 95, position: "DEF", img: "fifa-cards/thuram11.png" },
  { name: "Thuram", rating: 93, position: "DEF", img: "fifa-cards/thuram12.png" },
  { name: "Thuram", rating: 92, position: "DEF", img: "fifa-cards/thuram13.png" },
];

/* ================= DRAFT STATE ================= */

let deck = [...players];
let packCards = [];
let selectedPlayer = null;
let picksThisRound = 0;

const teamAPlayers = [];
const teamBPlayers = [];

const packEl = document.getElementById("pack");
const teamAEl = document.getElementById("teamA");
const teamBEl = document.getElementById("teamB");
const resultEl = document.getElementById("result");

/* ================= FORMATION ================= */

function buildTeam(el, team) {
  el.innerHTML = "";
  [3,3,4,1].forEach(count => {
    const row = document.createElement("div");
    row.className = "row";

    for (let i = 0; i < count; i++) {
      const slot = document.createElement("div");
      slot.className = "slot";
      slot.onclick = () => placeCard(slot, team);
      row.appendChild(slot);
    }

    el.appendChild(row);
  });
}

/* ================= PACK ================= */

function dealPack() {
  packEl.innerHTML = "";
  picksThisRound = 0;

  deck.sort(() => Math.random() - 0.5);
  packCards = deck.slice(0, 6);

  packCards.forEach(player => {
    const img = document.createElement("img");
    img.src = player.img;
    img.onclick = () => selectCard(player, img);
    packEl.appendChild(img);
  });
}

function selectCard(player, img) {
  selectedPlayer = player;
  [...packEl.children].forEach(i => i.style.opacity = 1);
  img.style.opacity = 0.4;
}

function placeCard(slot, team) {
  if (!selectedPlayer || slot.innerHTML) return;

  const img = document.createElement("img");
  img.src = selectedPlayer.img;
  slot.appendChild(img);

  (team === "A" ? teamAPlayers : teamBPlayers).push(selectedPlayer);
  deck = deck.filter(p => p !== selectedPlayer);

  selectedPlayer = null;
  picksThisRound++;

  if (picksThisRound === 2) dealPack();
}

/* ================= MATCH SIM ================= */

function teamStrength(team, pos) {
  return team
    .filter(p => p.position === pos)
    .reduce((s, p) => s + p.rating, 0);
}

function playMatch() {
  if (teamAPlayers.length < 11 || teamBPlayers.length < 11) {
    alert("Both teams must have 11 players");
    return;
  }

  const attackA = teamStrength(teamAPlayers, "ATT") + Math.random()*20;
  const attackB = teamStrength(teamBPlayers, "ATT") + Math.random()*20;

  const defenseA = teamStrength(teamAPlayers, "DEF") + teamStrength(teamAPlayers, "GK");
  const defenseB = teamStrength(teamBPlayers, "DEF") + teamStrength(teamBPlayers, "GK");

  const goalsA = Math.max(0, Math.round((attackA - defenseB) / 60 + Math.random()*2));
  const goalsB = Math.max(0, Math.round((attackB - defenseA) / 60 + Math.random()*2));

  resultEl.innerHTML = `
    FINAL SCORE<br>
    <strong>Team A ${goalsA} â€“ ${goalsB} Team B</strong>
  `;
}

/* ================= INIT ================= */

buildTeam(teamAEl, "A");
buildTeam(teamBEl, "B");
dealPack();
</script>

</body>
</html>
